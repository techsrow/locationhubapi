generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  role      Role     @default(ADMIN)
  createdAt DateTime @default(now())
}

model BrideGallery {
  id           String   @id @default(uuid())
  imageUrl     String
  displayorder Int      @default(0)
  createdAt    DateTime @default(now())
}

model GroomGallery {
  id           String   @id @default(uuid())
  imageUrl     String
  displayorder Int      @default(0)
  createdAt    DateTime @default(now())
}

model HomeSlider {
  id           String   @id @default(uuid())
  title        String?
  imageUrl     String
  displayorder Int
  createdAt    DateTime @default(now())
}

enum Role {
  ADMIN
}

model Set {
  id        String       @id @default(uuid())
  title     String
  mainImage String
  content   String       @db.Text // raw HTML from CKEditor
  createdAt DateTime     @default(now())
  pageUrl   String       @unique // ✅ ADD THIS
  gallery   SetGallery[]
}

model SetGallery {
  id           String   @id @default(uuid())
  imageUrl     String
  displayorder Int
  createdAt    DateTime @default(now())

  set   Set    @relation(fields: [setId], references: [id], onDelete: Cascade)
  setId String
}

model AddOnService {
  id           String   @id @default(uuid())
  title        String
  imageUrl     String
  pageUrl      String   @unique
  displayorder Int
  createdAt    DateTime @default(now())
}

model Testimonial {
  id           String   @id @default(uuid())
  title        String
  imageUrl     String
  displayorder Int
  createdAt    DateTime @default(now())
}

model Setup {
  id           String         @id @default(uuid())
  title        String
  slug         String         @unique
  mainImage    String
  content      String
  displayOrder Int
  createdAt    DateTime       @default(now())
  pageUrl      String         @unique // ✅ ADD THIS
  gallery      SetupGallery[]
}

model SetupGallery {
  id           String @id @default(uuid())
  imageUrl     String
  setupId      String // ✅ lower-case s
  displayOrder Int    @default(0)
  setup        Setup  @relation(fields: [setupId], references: [id], onDelete: Cascade)
}

model Props {
  id           String   @id @default(uuid())
  image        String
  title        String
  subTitle     String
  displayOrder Int
  createdAt    DateTime @default(now())
}

model MakeupArtist {
  id           String   @id @default(uuid())
  image        String
  displayOrder Int
  createdAt    DateTime @default(now())
}

model Product {
  id       String    @id @default(uuid())
  name     String
  price    Float
  slots    Slot[]
  bookings Booking[]
}

enum BookingStatus {
  locked
  paid
  completed
  cancelled
  expired
}

model Slot {
  id        String  @id @default(uuid())
  product   Product @relation(fields: [productId], references: [id])
  productId String
  label     String
  startTime String
  endTime   String

  bookings BookingSlot[] // ADD THIS
}

model Booking {
  id        String  @id @default(uuid())
  bookingId String  @unique
  productId String
  product   Product @relation(fields: [productId], references: [id])

  bookingDate DateTime

  customerName String?
  phone        String?
  email        String?

  totalAmount   Float?
  bookingAmount Float?
  gstAmount     Float?

  paymentStatus BookingStatus @default(locked)

  razorpayOrderId   String? @unique
  razorpayPaymentId String?

  lockExpiresAt DateTime?

  slots BookingSlot[]

  createdAt DateTime @default(now())
}

model BookingSlot {
  id String @id @default(uuid())

  booking   Booking @relation(fields: [bookingId], references: [id])
  bookingId String

  slot   Slot   @relation(fields: [slotId], references: [id])
  slotId String
}
